# Service Orders Commission Detail - Semantic Types Reference

## Overview

This document provides a quick reference for setting semantic types in Metabase for the **Service Orders Commission Detail** model.

**For detailed column mapping**: See [`SERVICE_ORDERS_COMMISSION_DETAIL.md`](./SERVICE_ORDERS_COMMISSION_DETAIL.md)

## Semantic Types by Column

| Column Name | Database Column (Features) | Database Column (Recurring Credits) | Database Column (One-Time Charges) | Semantic Type | Priority |
|------------|---------------------------|-------------------------------------|-----------------------------------|---------------|----------|
| `LINE_ITEM_TYPE` | Literal: 'Feature' | Literal: 'Recurring Credit' | Literal: 'One-Time Charge' | **Category** | ⭐ **HIGH** |
| `ORDER_ID` | `SERVICEORDERS.ORDER_ID` | `SERVICEORDERS.ORDER_ID` | `SERVICEORDERS.ORDER_ID` | **Entity Key** | ⭐ **HIGH** |
| `SERVICEORDER_ID` | `SERVICEORDERS.SERVICEORDER_ID` | `SERVICEORDERS.SERVICEORDER_ID` | `SERVICEORDERS.SERVICEORDER_ID` | **Entity Key** | ⭐ **HIGH** |
| `ACCOUNT_ID` | `SERVICEORDERS.ACCOUNT_ID` | `SERVICEORDERS.ACCOUNT_ID` | `SERVICEORDERS.ACCOUNT_ID` | **Entity Key** | ⭐ **HIGH** |
| `ACCOUNT_NUMBER` | `SERVICEORDERS.ACCOUNT_NUMBER` | `SERVICEORDERS.ACCOUNT_NUMBER` | `SERVICEORDERS.ACCOUNT_NUMBER` | **Entity Key** | Medium |
| `SERVICEORDER_STATUS` | `SERVICEORDERS.STATUS` | `SERVICEORDERS.STATUS` | `SERVICEORDERS.STATUS` | **Category** | ⭐ **HIGH** |
| `SERVICEORDER_TYPE` | `SERVICEORDERS.SERVICEORDER_TYPE` | `SERVICEORDERS.SERVICEORDER_TYPE` | `SERVICEORDERS.SERVICEORDER_TYPE` | **Category** | Medium |
| `SERVICELINE_NUMBER` | `SERVICEORDERS.SERVICELINE_NUMBER` | `SERVICEORDERS.SERVICELINE_NUMBER` | `SERVICEORDERS.SERVICELINE_NUMBER` | **Entity Key** | Medium |
| `SALES_AGENT` | `SERVICEORDERS.SALES_AGENT` | `SERVICEORDERS.SALES_AGENT` | `SERVICEORDERS.SALES_AGENT` | **Entity Name** | ⭐ **HIGH** |
| `SERVICEORDER_CREATED` | `SERVICEORDERS.CREATED_DATETIME` | `SERVICEORDERS.CREATED_DATETIME` | `SERVICEORDERS.CREATED_DATETIME` | **Creation Timestamp** | Medium |
| `SERVICEORDER_MODIFIED` | `SERVICEORDERS.MODIFIED_DATETIME` | `SERVICEORDERS.MODIFIED_DATETIME` | `SERVICEORDERS.MODIFIED_DATETIME` | **Modification Timestamp** | Low |
| `APPLY_DATE` | `SERVICEORDERS.APPLY_DATE` | `SERVICEORDERS.APPLY_DATE` | `SERVICEORDERS.APPLY_DATE` | **Date** | Low |
| `TARGET_DATETIME` | `SERVICEORDERS.TARGET_DATETIME` | `SERVICEORDERS.TARGET_DATETIME` | `SERVICEORDERS.TARGET_DATETIME` | **Date** | Low |
| `SERVICELINE_STARTDATE` | `SERVICELINES.SERVICELINE_STARTDATE` | `SERVICELINES.SERVICELINE_STARTDATE` | `SERVICELINES.SERVICELINE_STARTDATE` | **Creation Timestamp** | ⭐ **HIGH** |
| `SERVICELINE_ENDDATE` | `SERVICELINES.SERVICELINE_ENDDATE` | `SERVICELINES.SERVICELINE_ENDDATE` | `SERVICELINES.SERVICELINE_ENDDATE` | **Date** | Low |
| `SERVICELINE_STATUS` | `SERVICELINES.SERVICELINE_STATUS` | `SERVICELINES.SERVICELINE_STATUS` | `SERVICELINES.SERVICELINE_STATUS` | **Category** | Medium |
| `SERVICELINE_SERVICE_MODEL` | `SERVICELINES.SERVICE_MODEL` | `SERVICELINES.SERVICE_MODEL` | `SERVICELINES.SERVICE_MODEL` | **Category** | Medium |
| `ITEM_NAME` | `SERVICELINE_FEATURES.FEATURE` | `ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_NAME` | `ACCOUNT_OTHER_CHARGES_CREDITS.ITEM_NAME` | **Category** | ⭐ **HIGH** |
| `ITEM_PLAN` | `SERVICELINE_FEATURES.PLAN` | `CAST(NULL AS TEXT)` | `CAST(NULL AS TEXT)` | **Category** | Low |
| `RATE` | `SERVICELINE_FEATURES.FEATURE_PRICE` | `ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_AMOUNT` | `ACCOUNT_OTHER_CHARGES_CREDITS.OCC_AMOUNT` | **Currency** | ⭐ **HIGH** |
| `QUANTITY` | `SERVICELINE_FEATURES.QTY` | Literal: `1` | Literal: `1` | **Quantity** | ⭐ **HIGH** |
| `AMOUNT` | `FEATURE_PRICE * QTY` | `ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_AMOUNT` | `ACCOUNT_OTHER_CHARGES_CREDITS.OCC_AMOUNT` | **Currency** | ⭐ **HIGH** |
| `ITEM_START_DATETIME` | `SERVICELINE_FEATURES.START_DATETIME` | `ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_START_DATETIME` | `CAST(NULL AS TIMESTAMP_NTZ)` | **Creation Timestamp** | Low |
| `ITEM_END_DATETIME` | `SERVICELINE_FEATURES.END_DATETIME` | `ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_END_DATETIME` | `CAST(NULL AS TIMESTAMP_NTZ)` | **Date** | Low |
| `RECURRING_CREDIT_NAME` | `CAST(NULL AS TEXT)` | `ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_NAME` | `CAST(NULL AS TEXT)` | **Category** | Low |
| `ITEM_TYPE` | `CAST(NULL AS TEXT)` | `CAST(NULL AS TEXT)` | `ACCOUNT_OTHER_CHARGES_CREDITS.ITEM_TYPE` | **Category** | Low |
| `CHARGE_DATETIME` | `CAST(NULL AS TIMESTAMP_NTZ)` | `CAST(NULL AS TIMESTAMP_NTZ)` | `ACCOUNT_OTHER_CHARGES_CREDITS.OCC_DATETIME` | **Creation Timestamp** | Low |

## Priority Fields for Analysis

### ⭐ High Priority (Set These First)

1. **LINE_ITEM_TYPE** (Category) - Essential for filtering/separating features vs recurring credits vs one-time charges
2. **ORDER_ID** (Entity Key) - Primary grouping field for commission calculation
3. **SALES_AGENT** (Entity Name) - Required for sales commission reporting
4. **RATE** (Currency) - Rate per unit for all line item types
5. **QUANTITY** (Quantity) - Quantity for all line item types
6. **AMOUNT** (Currency) - Total amount (RATE × QUANTITY) for commission calculation
7. **ITEM_NAME** (Category) - Item name for all line item types
8. **SERVICEORDER_ID** (Entity Key) - Service order identifier
9. **ACCOUNT_ID** (Entity Key) - Account identifier
10. **SERVICELINE_STARTDATE** (Creation Timestamp) - Required: Service line start date
11. **SERVICEORDER_STATUS** (Category) - Should always be 'COMPLETED'

## Full Database Column Paths

### Features Query Columns

```
Literal: 'Feature' → LINE_ITEM_TYPE
CAMVIO.PUBLIC.SERVICEORDERS.ORDER_ID → ORDER_ID
CAMVIO.PUBLIC.SERVICEORDERS.SERVICEORDER_ID → SERVICEORDER_ID
CAMVIO.PUBLIC.SERVICEORDERS.ACCOUNT_ID → ACCOUNT_ID
CAMVIO.PUBLIC.SERVICEORDERS.ACCOUNT_NUMBER → ACCOUNT_NUMBER
CAMVIO.PUBLIC.SERVICEORDERS.STATUS → SERVICEORDER_STATUS
CAMVIO.PUBLIC.SERVICEORDERS.SERVICEORDER_TYPE → SERVICEORDER_TYPE
CAMVIO.PUBLIC.SERVICEORDERS.SERVICELINE_NUMBER → SERVICELINE_NUMBER
CAMVIO.PUBLIC.SERVICEORDERS.SALES_AGENT → SALES_AGENT
CAMVIO.PUBLIC.SERVICEORDERS.CREATED_DATETIME → SERVICEORDER_CREATED
CAMVIO.PUBLIC.SERVICEORDERS.MODIFIED_DATETIME → SERVICEORDER_MODIFIED
CAMVIO.PUBLIC.SERVICEORDERS.APPLY_DATE → APPLY_DATE
CAMVIO.PUBLIC.SERVICEORDERS.TARGET_DATETIME → TARGET_DATETIME
CAMVIO.PUBLIC.SERVICELINES.SERVICELINE_STARTDATE → SERVICELINE_STARTDATE
CAMVIO.PUBLIC.SERVICELINES.SERVICELINE_ENDDATE → SERVICELINE_ENDDATE
CAMVIO.PUBLIC.SERVICELINES.SERVICELINE_STATUS → SERVICELINE_STATUS
CAMVIO.PUBLIC.SERVICELINES.SERVICE_MODEL → SERVICELINE_SERVICE_MODEL
CAMVIO.PUBLIC.SERVICELINE_FEATURES.FEATURE → ITEM_NAME
CAMVIO.PUBLIC.SERVICELINE_FEATURES.PLAN → ITEM_PLAN
CAMVIO.PUBLIC.SERVICELINE_FEATURES.FEATURE_PRICE → RATE
CAMVIO.PUBLIC.SERVICELINE_FEATURES.QTY → QUANTITY
CAMVIO.PUBLIC.SERVICELINE_FEATURES.FEATURE_PRICE * QTY → AMOUNT
CAMVIO.PUBLIC.SERVICELINE_FEATURES.START_DATETIME → ITEM_START_DATETIME
CAMVIO.PUBLIC.SERVICELINE_FEATURES.END_DATETIME → ITEM_END_DATETIME
CAST(NULL AS TEXT) → RECURRING_CREDIT_NAME
CAST(NULL AS TEXT) → ITEM_TYPE
CAST(NULL AS TIMESTAMP_NTZ) → CHARGE_DATETIME
```

### Recurring Credits Query Columns

```
Literal: 'Recurring Credit' → LINE_ITEM_TYPE
CAMVIO.PUBLIC.SERVICEORDERS.ORDER_ID → ORDER_ID
CAMVIO.PUBLIC.SERVICEORDERS.SERVICEORDER_ID → SERVICEORDER_ID
CAMVIO.PUBLIC.SERVICEORDERS.ACCOUNT_ID → ACCOUNT_ID
CAMVIO.PUBLIC.SERVICEORDERS.ACCOUNT_NUMBER → ACCOUNT_NUMBER
CAMVIO.PUBLIC.SERVICEORDERS.STATUS → SERVICEORDER_STATUS
CAMVIO.PUBLIC.SERVICEORDERS.SERVICEORDER_TYPE → SERVICEORDER_TYPE
CAMVIO.PUBLIC.SERVICEORDERS.SERVICELINE_NUMBER → SERVICELINE_NUMBER
CAMVIO.PUBLIC.SERVICEORDERS.SALES_AGENT → SALES_AGENT
CAMVIO.PUBLIC.SERVICEORDERS.CREATED_DATETIME → SERVICEORDER_CREATED
CAMVIO.PUBLIC.SERVICEORDERS.MODIFIED_DATETIME → SERVICEORDER_MODIFIED
CAMVIO.PUBLIC.SERVICEORDERS.APPLY_DATE → APPLY_DATE
CAMVIO.PUBLIC.SERVICEORDERS.TARGET_DATETIME → TARGET_DATETIME
CAMVIO.PUBLIC.SERVICELINES.SERVICELINE_STARTDATE → SERVICELINE_STARTDATE
CAMVIO.PUBLIC.SERVICELINES.SERVICELINE_ENDDATE → SERVICELINE_ENDDATE
CAMVIO.PUBLIC.SERVICELINES.SERVICELINE_STATUS → SERVICELINE_STATUS
CAMVIO.PUBLIC.SERVICELINES.SERVICE_MODEL → SERVICELINE_SERVICE_MODEL
CAMVIO.PUBLIC.ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_NAME → ITEM_NAME
CAST(NULL AS TEXT) → ITEM_PLAN
CAMVIO.PUBLIC.ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_AMOUNT → RATE
Literal: 1 → QUANTITY
CAMVIO.PUBLIC.ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_AMOUNT → AMOUNT
CAMVIO.PUBLIC.ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_START_DATETIME → ITEM_START_DATETIME
CAMVIO.PUBLIC.ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_END_DATETIME → ITEM_END_DATETIME
CAMVIO.PUBLIC.ACCOUNT_RECURRING_CREDITS.RECURRING_CREDIT_NAME → RECURRING_CREDIT_NAME
CAST(NULL AS TEXT) → ITEM_TYPE
CAST(NULL AS TIMESTAMP_NTZ) → CHARGE_DATETIME
```

### One-Time Charges Query Columns

```
Literal: 'One-Time Charge' → LINE_ITEM_TYPE
CAMVIO.PUBLIC.SERVICEORDERS.ORDER_ID → ORDER_ID
CAMVIO.PUBLIC.SERVICEORDERS.SERVICEORDER_ID → SERVICEORDER_ID
CAMVIO.PUBLIC.SERVICEORDERS.ACCOUNT_ID → ACCOUNT_ID
CAMVIO.PUBLIC.SERVICEORDERS.ACCOUNT_NUMBER → ACCOUNT_NUMBER
CAMVIO.PUBLIC.SERVICEORDERS.STATUS → SERVICEORDER_STATUS
CAMVIO.PUBLIC.SERVICEORDERS.SERVICEORDER_TYPE → SERVICEORDER_TYPE
CAMVIO.PUBLIC.SERVICEORDERS.SERVICELINE_NUMBER → SERVICELINE_NUMBER
CAMVIO.PUBLIC.SERVICEORDERS.SALES_AGENT → SALES_AGENT
CAMVIO.PUBLIC.SERVICEORDERS.CREATED_DATETIME → SERVICEORDER_CREATED
CAMVIO.PUBLIC.SERVICEORDERS.MODIFIED_DATETIME → SERVICEORDER_MODIFIED
CAMVIO.PUBLIC.SERVICEORDERS.APPLY_DATE → APPLY_DATE
CAMVIO.PUBLIC.SERVICEORDERS.TARGET_DATETIME → TARGET_DATETIME
CAMVIO.PUBLIC.SERVICELINES.SERVICELINE_STARTDATE → SERVICELINE_STARTDATE
CAMVIO.PUBLIC.SERVICELINES.SERVICELINE_ENDDATE → SERVICELINE_ENDDATE
CAMVIO.PUBLIC.SERVICELINES.SERVICELINE_STATUS → SERVICELINE_STATUS
CAMVIO.PUBLIC.SERVICELINES.SERVICE_MODEL → SERVICELINE_SERVICE_MODEL
CAMVIO.PUBLIC.ACCOUNT_OTHER_CHARGES_CREDITS.ITEM_NAME → ITEM_NAME
CAST(NULL AS TEXT) → ITEM_PLAN
CAMVIO.PUBLIC.ACCOUNT_OTHER_CHARGES_CREDITS.OCC_AMOUNT → RATE
Literal: 1 → QUANTITY
CAMVIO.PUBLIC.ACCOUNT_OTHER_CHARGES_CREDITS.OCC_AMOUNT → AMOUNT
CAST(NULL AS TIMESTAMP_NTZ) → ITEM_START_DATETIME
CAST(NULL AS TIMESTAMP_NTZ) → ITEM_END_DATETIME
CAST(NULL AS TEXT) → RECURRING_CREDIT_NAME
CAMVIO.PUBLIC.ACCOUNT_OTHER_CHARGES_CREDITS.ITEM_TYPE → ITEM_TYPE
CAMVIO.PUBLIC.ACCOUNT_OTHER_CHARGES_CREDITS.OCC_DATETIME → CHARGE_DATETIME
```

## Setting Semantic Types in Metabase

### Method 1: Model Settings (Recommended)

1. Open the **Service Orders Commission Detail** model
2. Click **Model settings** (gear icon)
3. Go to **Column metadata** tab
4. For each column:
   - Set **Semantic type** from dropdown
   - Review **Database column** (shown automatically)
5. Save changes

### Method 2: Individual Column Settings

1. Open the model
2. Click on a column header
3. Select **Column settings**
4. Set **Semantic type**
5. Save

## Quick Setup Checklist

- [ ] Set `LINE_ITEM_TYPE` → **Category**
- [ ] Set `ORDER_ID` → **Entity Key**
- [ ] Set `SERVICEORDER_ID` → **Entity Key**
- [ ] Set `ACCOUNT_ID` → **Entity Key**
- [ ] Set `ACCOUNT_NUMBER` → **Entity Key**
- [ ] Set `SERVICELINE_NUMBER` → **Entity Key**
- [ ] Set `SALES_AGENT` → **Entity Name**
- [ ] Set `SERVICEORDER_STATUS` → **Category**
- [ ] Set `SERVICEORDER_TYPE` → **Category**
- [ ] Set `SERVICELINE_STATUS` → **Category**
- [ ] Set `SERVICELINE_SERVICE_MODEL` → **Category**
- [ ] Set `ITEM_NAME` → **Category**
- [ ] Set `ITEM_PLAN` → **Category**
- [ ] Set `RATE` → **Currency**
- [ ] Set `QUANTITY` → **Quantity**
- [ ] Set `AMOUNT` → **Currency**
- [ ] Set `RECURRING_CREDIT_NAME` → **Category**
- [ ] Set `ITEM_TYPE` → **Category**
- [ ] Set `SERVICELINE_STARTDATE` → **Creation Timestamp**
- [ ] Set `SERVICEORDER_CREATED` → **Creation Timestamp**
- [ ] Set `SERVICEORDER_MODIFIED` → **Modification Timestamp**
- [ ] Set `ITEM_START_DATETIME` → **Creation Timestamp**
- [ ] Set `ITEM_END_DATETIME` → **Date**
- [ ] Set `CHARGE_DATETIME` → **Creation Timestamp**
- [ ] Set date fields (`APPLY_DATE`, `TARGET_DATETIME`, `SERVICELINE_ENDDATE`) → **Date**

## Notes

- **UNION ALL Structure**: This model uses UNION ALL to combine features, recurring credits, and one-time charges. Some fields are NULL for certain types (e.g., `ITEM_PLAN` is NULL for charges, `RECURRING_CREDIT_NAME` is NULL for features and one-time charges).

- **Unified Fields**: `RATE`, `QUANTITY`, and `AMOUNT` are unified across all line item types, making it easy to calculate commissions by grouping on `ORDER_ID`.

- **Quantity Field**: 
  - Features: Uses actual `QTY` from `SERVICELINE_FEATURES`
  - Recurring Credits: Set to `1` (each record = one recurring credit)
  - One-Time Charges: Set to `1` (each record = one one-time charge)

- **Amount Field**: 
  - Features: `AMOUNT = RATE × QUANTITY` (FEATURE_PRICE × QTY)
  - Recurring Credits: `AMOUNT = RATE` (RECURRING_CREDIT_AMOUNT)
  - One-Time Charges: `AMOUNT = RATE` (OCC_AMOUNT)

- **Currency Fields**: Setting `RATE` and `AMOUNT` as Currency enables proper formatting and currency-specific aggregations in Metabase.

- **Entity Name**: Setting `SALES_AGENT` as Entity Name enables better person name handling and search, which is important for sales commission reporting.

- **Line Item Type Distinction**: The `LINE_ITEM_TYPE` field ('Feature', 'Recurring Credit', 'One-Time Charge') is essential for filtering and grouping in commission calculations.

